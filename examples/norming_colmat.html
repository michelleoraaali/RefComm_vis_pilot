<!DOCTYPE html>
<html>
  <head>

    <script src="../jspsych.js"></script>
    <script src="../plugins/jspsych-survey-text.js"></script>
    <script src="../plugins/jspsych-html-keyboard-response.js"></script>
    <script src="../plugins/jspsych-survey-multi-choice.js"></script>
    <link rel="stylesheet" href="../css/jspsych.css"></link>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  </head>
  <body></body>
  <script>
  var timeline = []

  /* define welcome message trial */
    var welcome_block = {
      type: "html-keyboard-response",
      stimulus: "Welcome to the experiment. Press any key to begin."
    };
    timeline.push(welcome_block);

    /* define participant info trial */
    var survey_trial = {
    type: 'survey-text',
    preamble: "Proceed ONLY after submitting your WorkerID.",
    questions: [{prompt: "What is your WorkerID?"}, {prompt: "What is your age?"}]
    };
    timeline.push(survey_trial);

    /* Native Eng Speaker trial */
    var multi_choice_block = {
      type: 'survey-multi-choice',
      questions: [{prompt: "Are you a native English speaker?", options: ['Yes','No'], required:true,}],
    };
    timeline.push(multi_choice_block);

/*  var survey_block_mat = {
      type: 'survey-text',
      preamble: ['<img src ="img/yellow_leather_boot.png"></img>'],
      questions: [
        {prompt: 'What material is this object made of?', columns: 50},
      ]
  };

  var survey_block_col = {
      type: 'survey-text',
      preamble: ['<img src ="img/yellow_leather_boot.png"></img>'],
      questions: [
        {prompt: 'What color is this object?', columns: 50},
      ]
  };*/

  function saveData(name, data){
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '../write_data_norming.php'); // 'write_data.php' is the path to the php file described above.
    xhr.setRequestHeader('Content-Type', 'application/json');
    console.log( data );
    xhr.send(JSON.stringify({filename: name, filedata: data}));
    console.log(xhr);
  }

      // generate a random subject ID with 15 characters
    var subject_id = jsPsych.randomization.randomID(15);
    jsPsych.data.addProperties({
      subject: subject_id,
        });

   var images = [
    'img/black_cotton_pants.png',
    'img/black_leather_pants.png',
    'img/blue_cotton_lunchbag.png',
    'img/blue_glass_ball.png',
    'img/blue_glass_jar.png',
    'img/blue_metal_toolbox.png',
    'img/blue_plastic_straw_2.png',
    'img/blue_plastic_straw.png',
    'img/blue_woolen_ball.png',
    'img/green_plastic_clock_2.png',
    'img/green_plastic_clock.png',
    'img/green_plastic_spoon.png',
    'img/orange_metal_cart.png',
    'img/purple_cotton_lunchbag.png',
    'img/purple_plastic_gloves.png',
    'img/red_cotton_shoe.png',
    'img/red_leather_shoe.png',
    'img/red_plastic_spoon.png',
    'img/red_plastic_toolbox.png',
    'img/red_woolen_gloves.png',
    'img/white_wooden_cart.png',
    'img/yellow_glass_jar.png',
    'img/yellow_plastic_constructionhat_2.png',
    'img/yellow_plastic_constructionhat.png',
    'img/white_cotton_sock.png',
    'img/pink_woolen_sock.png',
    'img/black_metal_bowl.png',
    'img/orange_ceramic_bowl.png',
    'img/yellow_woolen_scarf.png',
    'img/purple_cotton_scarf.png',
    'img/brown_wooden_sofa.png',
    'img/blue_leather_sofa.png',
    'img/brown_cardboard_train.png',
    'img/black_metal_train.png',
    'img/white_paper_bag.png',
    'img/green_plastic_bag.png',
    'img/yellow_plastic_bottle.png',
    'img/orange_glass_bottle.png',
    'img/pink_ceramic_pot.png',
    'img/green_glass_pot.png',
    'img/red_wooden_house.png',
    'img/blue_cardboard_house.png',
    'img/purple_paper_notebook.png',
    'img/red_leather_notebook.png',
    'img/yellow_plastic_organizer.png',
    'img/yellow_cardboard_organizer.png',
    'img/white_paper_flower.png',
    'img/white_cardboard_flower.png',
    'img/red_wooden_box.png',
    'img/red_plastic_box.png',
    'img/purple_glass_cup.png',
    'img/purple_ceramic_cup.png',
    'img/pink_woolen_coat.png',
    'img/pink_cotton_coat.png',
    'img/orange_paper_pumpkin.png',
    'img/orange_glass_pumpkin.png',
    'img/green_metal_lamp.png',
    'img/green_ceramic_lamp.png',
    'img/brown_metal_bench.png',
    'img/brown_leather_bench.png',
    'img/blue_woolen_hat.png',
    'img/blue_cotton_hat.png',
    'img/black_leather_chair.png',
    'img/black_wooden_chair.png',
    'img/yellow_woolen_beanie.png',
    'img/yellow_woolen_beanie_2.png',
    'img/white_wooden_dresser.png',
    'img/white_wooden_dresser_2.png',
    'img/red_glass_vase.png',
    'img/red_glass_vase_2.png',
    'img/purple_plastic_fork.png',
    'img/purple_plastic_fork_2.png',
    'img/pink_paper_napkin.png',
    'img/pink_paper_napkin_2.png',
    'img/orange_metal_chair.png',
    'img/orange_metal_chair_2.png',
    'img/green_leather_jacket.png',
    'img/green_leather_jacket_2.png',
    'img/brown_cotton_shirt.png',
    'img/brown_cotton_shirt_2.png',
    'img/blue_ceramic_jug.png',
    'img/black_cardboard_box.png',
    'img/blue_ceramic_jug_2.png',
    'img/black_cardboard_box_2.png',
    'img/yellow_leather_boot.png',
    'img/yellow_cotton_dress.png',
    'img/white_paper_lantern.png',
    'img/white_cardboard_tube.png',
    'img/red_wooden_cupboard.png',
    'img/red_paper_lantern.png',
    'img/purple_plastic_cup.png',
    'img/purple_metal_bucket.png',
    'img/pink_glass_bottle.png',
    'img/pink_ceramic_plate.png',
    'img/orange_woolen_sweater.png',
    'img/orange_plastic_cup.png',
    'img/green_cotton_dress.png',
    'img/green_ceramic_plate.png',
    'img/brown_woolen_sweater.png',
    'img/brown_cardboard_tube.png',
    'img/blue_wooden_cupboard.png',
    'img/blue_glass_bottle.png',
    'img/black_metal_bucket.png',
    'img/black_leather_boot.png',
    'img/control_black_metal.png',
    'img/control_blue_glass.png',
    'img/control_brown_wood.png',
    'img/control_green_cardboard.png',
    'img/control_orange_wool.png',
    'img/control_pink_cotton.png',
    'img/control_purple_leather.png',
    'img/control_red_ceramic.png',
    'img/control_white_paper.png',
    'img/control_yellow_plastic.png',];

        /* define instructions trial */
    var instructions = {
      type: "html-keyboard-response",
      stimulus: "<p>In this task we are going to show you a series of pictures of everyday objects and we want you to indicate which COLOR each object is. Note that we are interested in basic color terms (blue, red, orange etc.), NOT fancy words for rare colors (lavender, fuchsia, vermillion etc.).</p><p>Press any key to begin.</p>",
      post_trial_gap: 500
    };
    timeline.push(instructions);

  var normingstim = [
    {preamble: '<img src="img/control_black_metal.png"></img>'},
    {preamble: '<img src="img/control_blue_glass.png"></img>'},
    {preamble: '<img src="img/control_brown_wood.png"></img>'},
    {preamble: '<img src="img/control_green_cardboard.png"></img>'},
    {preamble: '<img src="img/control_orange_wool.png"></img>'},
    {preamble: '<img src="img/control_pink_cotton.png"></img>'},
    {preamble: '<img src="img/control_purple_leather.png"></img>'},
    {preamble: '<img src="img/control_red_ceramic.png"></img>'},
    {preamble: '<img src="img/control_white_paper.png"></img>'},
    {preamble: '<img src="img/control_yellow_plastic.png"></img>'},
    {preamble: '<img src="img/black_cotton_pants.png"></img>'},
    {preamble: '<img src="img/black_leather_pants.png"></img>'},
    {preamble: '<img src="img/blue_cotton_lunchbag.png"></img>'},
    {preamble: '<img src="img/blue_glass_ball.png"></img>'},
    {preamble: '<img src="img/blue_glass_jar.png"></img>'},
    {preamble: '<img src="img/blue_metal_toolbox.png"></img>'},
    {preamble: '<img src="img/blue_plastic_straw_2.png"></img>'},
    {preamble: '<img src="img/blue_plastic_straw.png"></img>'},
    {preamble: '<img src="img/blue_woolen_ball.png"></img>'},
    {preamble: '<img src="img/green_plastic_clock_2.png"></img>'},
    {preamble: '<img src="img/green_plastic_clock.png"></img>'},
    {preamble: '<img src="img/green_plastic_spoon.png"></img>'},
    {preamble: '<img src="img/orange_metal_cart.png"></img>'},
    {preamble: '<img src="img/purple_cotton_lunchbag.png"></img>'},
    {preamble: '<img src="img/purple_plastic_gloves.png"></img>'},
    {preamble: '<img src="img/red_cotton_shoe.png"></img>'},
    {preamble: '<img src="img/red_leather_shoe.png"></img>'},
    {preamble: '<img src="img/red_plastic_spoon.png"></img>'},
    {preamble: '<img src="img/red_plastic_toolbox.png"></img>'},
    {preamble: '<img src="img/red_woolen_gloves.png"></img>'},
    {preamble: '<img src="img/white_wooden_cart.png"></img>'},
    {preamble: '<img src="img/yellow_glass_jar.png"></img>'},
    {preamble: '<img src="img/yellow_plastic_constructionhat_2.png"></img>'},
    {preamble: '<img src="img/yellow_plastic_constructionhat.png"></img>'},
    {preamble: '<img src="img/white_cotton_sock.png"></img>'},
    {preamble: '<img src="img/pink_woolen_sock.png"></img>'},
    {preamble: '<img src="img/black_metal_bowl.png"></img>'},
    {preamble: '<img src="img/orange_ceramic_bowl.png"></img>'},
    {preamble: '<img src="img/yellow_woolen_scarf.png"></img>'},
    {preamble: '<img src="img/purple_cotton_scarf.png"></img>'},
    {preamble: '<img src="img/brown_wooden_sofa.png"></img>'},
    {preamble: '<img src="img/blue_leather_sofa.png"></img>'},
    {preamble: '<img src="img/brown_cardboard_train.png"></img>'},
    {preamble: '<img src="img/black_metal_train.png"></img>'},
    {preamble: '<img src="img/white_paper_bag.png"></img>'},
    {preamble: '<img src="img/green_plastic_bag.png"></img>'},
    {preamble: '<img src="img/yellow_plastic_bottle.png"></img>'},
    {preamble: '<img src="img/orange_glass_bottle.png"></img>'},
    {preamble: '<img src="img/pink_ceramic_pot.png"></img>'},
    {preamble: '<img src="img/green_glass_pot.png"></img>'},
    {preamble: '<img src="img/red_wooden_house.png"></img>'},
    {preamble: '<img src="img/blue_cardboard_house.png"></img>'},
    {preamble: '<img src="img/purple_paper_notebook.png"></img>'},
    {preamble: '<img src="img/red_leather_notebook.png"></img>'},
    {preamble: '<img src="img/yellow_plastic_organizer.png"></img>'},
    {preamble: '<img src="img/yellow_cardboard_organizer.png"></img>'},
    {preamble: '<img src="img/white_paper_flower.png"></img>'},
    {preamble: '<img src="img/white_cardboard_flower.png"></img>'},
    {preamble: '<img src="img/red_wooden_box.png"></img>'},
    {preamble: '<img src="img/red_plastic_box.png"></img>'},
    {preamble: '<img src="img/purple_glass_cup.png"></img>'},
    {preamble: '<img src="img/purple_ceramic_cup.png"></img>'},
    {preamble: '<img src="img/pink_woolen_coat.png"></img>'},
    {preamble: '<img src="img/pink_cotton_coat.png"></img>'},
    {preamble: '<img src="img/orange_paper_pumpkin.png"></img>'},
    {preamble: '<img src="img/orange_glass_pumpkin.png"></img>'},
    {preamble: '<img src="img/green_metal_lamp.png"></img>'},
    {preamble: '<img src="img/green_ceramic_lamp.png"></img>'},
    {preamble: '<img src="img/brown_metal_bench.png"></img>'},
    {preamble: '<img src="img/brown_leather_bench.png"></img>'},
    {preamble: '<img src="img/blue_woolen_hat.png"></img>'},
    {preamble: '<img src="img/blue_cotton_hat.png"></img>'},
    {preamble: '<img src="img/black_leather_chair.png"></img>'},
    {preamble: '<img src="img/black_wooden_chair.png"></img>'},
    {preamble: '<img src="img/yellow_woolen_beanie.png"></img>'},
    {preamble: '<img src="img/yellow_woolen_beanie_2.png"></img>'},
    {preamble: '<img src="img/white_wooden_dresser.png"></img>'},
    {preamble: '<img src="img/white_wooden_dresser_2.png"></img>'},
    {preamble: '<img src="img/red_glass_vase.png"></img>'},
    {preamble: '<img src="img/red_glass_vase_2.png"></img>'},
    {preamble: '<img src="img/purple_plastic_fork.png"></img>'},
    {preamble: '<img src="img/purple_plastic_fork_2.png"></img>'},
    {preamble: '<img src="img/pink_paper_napkin.png"></img>'},
    {preamble: '<img src="img/pink_paper_napkin_2.png"></img>'},
    {preamble: '<img src="img/orange_metal_chair.png"></img>'},
    {preamble: '<img src="img/orange_metal_chair_2.png"></img>'},
    {preamble: '<img src="img/green_leather_jacket.png"></img>'},
    {preamble: '<img src="img/green_leather_jacket_2.png"></img>'},
    {preamble: '<img src="img/brown_cotton_shirt.png"></img>'},
    {preamble: '<img src="img/brown_cotton_shirt_2.png"></img>'},
    {preamble: '<img src="img/blue_ceramic_jug.png"></img>'},
    {preamble: '<img src="img/black_cardboard_box.png"></img>'},
    {preamble: '<img src="img/blue_ceramic_jug_2.png"></img>'},
    {preamble: '<img src="img/black_cardboard_box_2.png"></img>'},
    {preamble: '<img src="img/yellow_leather_boot.png"></img>'},
    {preamble: '<img src="img/yellow_cotton_dress.png"></img>'},
    {preamble: '<img src="img/white_paper_lantern.png"></img>'},
    {preamble: '<img src="img/white_cardboard_tube.png"></img>'},
    {preamble: '<img src="img/red_wooden_cupboard.png"></img>'},
    {preamble: '<img src="img/red_paper_lantern.png"></img>'},
    {preamble: '<img src="img/purple_plastic_cup.png"></img>'},
    {preamble: '<img src="img/purple_metal_bucket.png"></img>'},
    {preamble: '<img src="img/pink_glass_bottle.png"></img>'},
    {preamble: '<img src="img/pink_ceramic_plate.png"></img>'},
    {preamble: '<img src="img/orange_woolen_sweater.png"></img>'},
    {preamble: '<img src="img/orange_plastic_cup.png"></img>'},
    {preamble: '<img src="img/green_cotton_dress.png"></img>'},
    {preamble: '<img src="img/green_ceramic_plate.png"></img>'},
    {preamble: '<img src="img/brown_woolen_sweater.png"></img>'},
    {preamble: '<img src="img/brown_cardboard_tube.png"></img>'},
    {preamble: '<img src="img/blue_wooden_cupboard.png"></img>'},
    {preamble: '<img src="img/blue_glass_bottle.png"></img>'},
    {preamble: '<img src="img/black_metal_bucket.png"></img>'},
    {preamble: '<img src="img/black_leather_boot.png"></img>'}
	]

    var survey_block_norm_1 = {
      type: 'survey-text',
      preamble: jsPsych.timelineVariable('preamble'),
      questions: [ {prompt: 'What color is this object?', columns: 50},]
  };

        var test_procedure_1 = {
      timeline: [survey_block_norm_1],
      timeline_variables: normingstim,
      randomize_order: true
    }
    timeline.push(test_procedure_1);

          /* define instructions trial */
    var instructions2 = {
      type: "html-keyboard-response",
      stimulus: "<p>You have completed half the task. Now we would like you to look at the same pictures again but indicate which MATERIAL each object is made of. Note that we are interested in basic terms for the object's MATERIAL (leather, metal, wood etc), not fancy or ultra-specific words.</p>"+
          "<p>Press any key to begin.</p>",
      post_trial_gap: 500
    };
    timeline.push(instructions2);

    var survey_block_norm_2 = {
      type: 'survey-text',
      preamble: jsPsych.timelineVariable('preamble'),
      questions: [ {prompt: 'What material is this object made of?', columns: 50},]
  };


      var test_procedure_2 = {
      timeline: [survey_block_norm_2],
      timeline_variables: normingstim,
      randomize_order: true
    }
    timeline.push(test_procedure_2);

              /* define instructions trial */
    var instructions3 = {
      type: "html-keyboard-response",
      stimulus: "<p>You have completed the task! Thank you for your participation!</p>"+
          "<p>Press any key to submit.</p>",
      post_trial_gap: 500
    };
    timeline.push(instructions3);


    var data = jsPsych.data.get().filter({trial_type: 'survey-text'});


  jsPsych.init({
   /* timeline: [survey_block_mat, survey_block_col, test_procedure],*/
    timeline: timeline,
    preload_images: images,
    show_preload_progress_bar: true, // hide preload progress bar
    //on_finish: function() { jsPsych.data.displayData(); },
    on_finish: function(){ saveData(subject_id+"_"+"norming"+"colmat"+"experiment_data", jsPsych.data.get().csv()); }
  });

  </script>
</html>
